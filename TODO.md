rewrite and unit-test LargeArrayBuilder
rewrite and unit-test CodeBuilder